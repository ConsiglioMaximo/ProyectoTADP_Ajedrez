import tablero.tablero
import piezas.reina.Reina
import piezas.peon.Peon

describe "Movimientos de la reina" {

  test "reina se mueve en rectas libres" {
 
    tablero.crearCasilleros()

    const reina = new Reina()
    reina.esBlanco(true)

    const c44 = tablero.dameElCasillero(4,4)
    c44.ocuparCon(reina)

    const movs = reina.posiblesMovimientos()

    const c45 = tablero.dameElCasillero(4, 5)   // 1 derecha
    const c64 = tablero.dameElCasillero(6,4)   // 2 arriba
    const c41 = tablero.dameElCasillero(4, 1)   // 3 izquierda
    const c04 = tablero.dameElCasillero(0,4)   // 4 abajo

    assert.equals(true, movs.contains(c45))
    assert.equals(true, movs.contains(c64))
    assert.equals(true, movs.contains(c41))
    assert.equals(true, movs.contains(c04))

    assert.equals(false, movs.contains(c44))  // no debería incluir el casillero donde está parado
  }

    test "reina relacion con aliado y enemigo" {

    tablero.crearCasilleros()

    const reina = new Reina()
    reina.esBlanco(true)

    const origen = tablero.dameElCasillero(3, 3)
    origen.ocuparCon(reina)

    // Pieza amiga en (5,3) → bloquea esa diagonal
    const peonAmigo = new Peon()
    peonAmigo.esBlanco(true)
    const c53 = tablero.dameElCasillero(5, 3)
    c53.ocuparCon(peonAmigo)

    // Pieza enemiga en (3,1 ) → debería poder comerla
    const peonEnemigo = new Peon()
    peonEnemigo.esBlanco(false)
    const c31 = tablero.dameElCasillero(3,1)
    c31.ocuparCon(peonEnemigo)

    const movs = reina.posiblesMovimientos()

    const c43 = tablero.dameElCasillero(4, 3) // este esta antes del peon -> puede
    const c63 = tablero.dameElCasillero(6, 3) // despues del peon -> no puede
    const c30 =tablero.dameElCasillero(3, 0) // despues del peon enemigo -> no puede

    assert.equals(true, movs.contains(c43))
    assert.equals(false, movs.contains(c63))
    assert.equals(false, movs.contains(c30))

    // No puede ir donde está el amigo
    assert.equals(false, movs.contains(c53))

    // Sí debe incluir al enemigo (1,5)
    assert.equals(true, movs.contains(c31))
  }
}